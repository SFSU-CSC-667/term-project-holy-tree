<div class="game-info">
    <h2><span id='game-player-count'>1</span> / 3 Players</span></h2>
</div>

<div class="chat-container">
    <ul id="messages"></ul>
    <form>
        <input type="text" id="message-input">
        <input type="submit" value="Send">
    </form>
</div>

<script type="text/javascript">
  var socket = io.connect();
  
  socket.emit( 'subscribe to game', { game: {{ game_id }}, user_name: '{{ user_name }}' } );

  $('form').submit( function(){
    socket.emit('chat message', { message: $('#message-input').val(), user_name: '{{ user_name }}', game: {{ game_id }} });
    $('#message-input').val('');

    return false;
  });

  socket.on('chat message', function( msg ) {
    $('#messages').append($('<li>').text( msg["user_name"] + ": " + msg["message"] ));
  });

  socket.on('player joined', function (data) {
    $('#game-player-count').text(data.player_count);
  });
</script>